@{
    Layout = null;
}
@using System.Security.Claims;
@{
    var userRole = User.FindFirst(ClaimTypes.Role)?.Value;
    var userName = User.FindFirst(ClaimTypes.UserData)?.Value;
    var TenNguoiDung = User.FindFirst(ClaimTypes.Name)?.Value;
    
}

@model List<QuanLyKhachSan.Models.Phong>
@inject ApplicationDbContext _db;

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    <title>Trang chủ khách hàng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="~/css/CssTrangChuKhachHang.css" rel="stylesheet" />
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />



    <style>
        .swiper-image {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
        }

        .swiper-container {
            position: relative;
            z-index: 1;
        }

        .profile {
            position: relative;
        }

            .profile img {
                width: 36px;
                height: 36px;
                border-radius: 50%;
                object-fit: cover;
                cursor: pointer;
                z-index: 999;
            }

            .profile .profile-link {
                position: absolute;
                top: calc(100% + 10px);
                right: 0;
                background: var(--light);
                padding: 10px 0;
                box-shadow: 4px 4px 16px rgba(0, 0, 0, .1);
                border-radius: 10px;
                width: 160px;
                opacity: 0;
                pointer-events: none;
                transition: all .3s ease;
            }

                .profile .profile-link.show {
                    opacity: 1;
                    background: white;
                    pointer-events: visible;
                    top: 100%;
                    z-index: 999;
                }

                .profile .profile-link a {
                    padding: 10px 16px;
                    display: flex;
                    grid-gap: 10px;
                    font-size: 14px;
                    color: var(--dark);
                    align-items: center;
                    transition: all .3s ease;
                }

        .profile .profile-link a:hover {
            background: var(--grey);
            text-decoration: none;
        }
    </style>
</head>


<body>

    <div id="container">
        <nav>
            <div class="logo">
                <a class="active" asp-action="Index" asp-controller="TrangChuKhachHang"> <img src="https://i.ibb.co/HXp0Y2Y/Screenshot-2-preview-rev-1.png" alt=""></a>
            </div>
            <ul>
                <li><a class="active" asp-action="Index" asp-controller="TrangChuKhachHang">Trang chủ</a></li>
                <li><a class="smooth-scroll" href="#PhanTimKiemPhong">Tìm kiếm phòng</a></li>
            </ul>
            <input type="checkbox" id="click">
            <label for="click" class="menu-btn">
                <i class="fas fa-bars" style="color: black;"></i>
            </label>
            <ul>

                @if (userName == null)
                {
                    <li>
                        <a asp-action="Login" asp-controller="Access">Đăng nhập </a>
                    </li>
                    <li>
                        <p style="  font-size: 18px; font-weight: 500;">|</p>
                    </li>
                    <li><a asp-action="GiaoDienDangKy" asp-controller="Access">Đăng ký</a></li>
                }
                else
                {
                    <div class="profile">
                        <span>Xin chào! @TenNguoiDung</span>
                        <img src="https://cdn.gogeticon.net/files/1925428/fa0cbc2764f70113bf2fad3905933545.png">
                        <ul class="profile-link">
                            @if (userRole == "Nhân viên" || userRole =="Quản lý")
                            {
                                 <li><a asp-action="Index" asp-controller="Home" style="margin-left:9px">Quản lý</a></li>
                            }
                           
                            <li><a asp-action="LogOut" asp-controller="Home"><i class='bx bxs-log-out'></i> Đăng xuất</a></li>
                        </ul>
                    </div>

                    @*   <li>Xin chào! @TenNguoiDung</li>
                <li>
                <a class="text-primary" asp-action="Index" asp-controller="Home">Trở về trang quản lý</a>
                </li>
                <li>
                <a asp-action="LogOut" asp-controller="TrangChuKhachHang" class="text-danger"><i class="bi bi-box-arrow-left"></i>   Đăng xuất</a>
                </li> *@

                }
            </ul>
        </nav>




        <div class="swiper-container" style="overflow:hidden">
            <div class="swiper-wrapper">
                <!-- Slide 1 -->
                <div class="swiper-slide">
                    <div class="img-hotel">
                        <img src="https://www.sripanwa.com/images/hero-banner/luxury-pool-villa-phuket-hotel-private-residences-villa-sri-panwa.jpg" alt="Hotel Image 1" class="swiper-image" />
                    </div>
                </div>

                <!-- Slide 2 -->
                <div class="swiper-slide">
                    <div class="img-hotel">
                        <img src="https://www.sripanwa.com/images/hero-banner/luxury-pool-villa-hotel-best-exclusive-rooftop-bar.jpg" alt="Hotel Image 2" class="swiper-image" />
                    </div>
                </div>

                <!-- Slide 3 -->
                <div class="swiper-slide">
                    <div class="img-hotel">
                        <img src="https://www.sripanwa.com/images/villas/luxury-pool-villa-hotel-yaya-pool-suite-ocean-private-pool-1.jpg" alt="Hotel Image 3" class="swiper-image" />
                    </div>
                </div>
            </div>

            <!-- Phần tìm kiếm phòng -->
            <div id="PhanTimKiemPhong" class="sreach-room">
                <h2 class="p-2">Tìm phòng</h2>
                <div class="address row">

                    <div class="col-md-2 mb-3 mx-auto">
                        <label for="ngaynhan">Ngày nhận </label>
                        <div class="input-group date" id="ngaynhanPicker" data-target-input="nearest">
                            <input type="datetime-local" class="form-control datetimepicker-input"
                                   data-target="#ngaynhanPicker" id="ipt_NgayNhan" />
                        </div>
                        <span id="Error_NgayNhan" style="color: red;"></span>
                    </div>

                    <div class="col-md-2 mb-3 mx-auto">
                        <label for="ngaytra"> Ngày trả</label>
                        <div class="input-group date" id="ngaytraPicker" data-target-input="nearest">
                            <input type="datetime-local" class="form-control datetimepicker-input"
                                   data-target="#ngaytraPicker" id="ipt_NgayTra" />
                        </div>
                        <span id="Error_NgayTra" style="color: red;"></span>
                    </div>

                    <div class="col-md-1 mb-3 so-phong mx-auto">
                        <label for="sophong">SL người lớn</label>
                        <div class="input-group date" id="ngaytraPicker" data-target-input="nearest">
                            <input type="number" id="SlNguoiLon" class="form-control" value="1" min="1" required onkeypress="return event.charCode >= 48" onblur="if(this.value=='' || this.value==0){this.value='1'}" />
                        </div>
                    </div>

                    <div class="col-md-1 mb-1 so-phong mx-auto">
                        <label for="sophong">SL trẻ em</label>
                        <div class="input-group date" id="ngaytraPicker" data-target-input="nearest">
                            <input type="number" id="SlTreEm" class="form-control" value="1" min="0" onkeypress="return event.charCode >= 48" onblur="if(this.value==''){this.value='0'}" required />
                        </div>
                    </div>

                    <div class="col-md-2 Tim-kiem mx-auto">
                        <a class="btn btn-warning" id="TimKiemPhong">Tìm kiếm phòng</a>
                    </div>
                </div>
            </div>
        </div>



        <div id="Report_Phong">
            <p class="report_Phong_Text">Rất tiếc, quý khách chưa tìm phòng hoặc phòng tìm kiếm không hợp lệ!</p>
        </div>
        <div id="room-infor" class="container">
            <div class="row">
                <div class="col-md-8">
                    @foreach (var phong in Model)
                    {
                        <div class="room-detail" data-room-id="@phong.MaPhong">
                            @if (phong.ImageLinks != null && phong.ImageLinks.Any())
                            {

                                <div class="slider" data-current-index="0">
                                    <button class="prev btn btn-outline-success">
                                        <i class="bi bi-arrow-left"></i>
                                    </button>
                                    <img src="~/UploadImage/@phong.ImageLinks.First().Url" alt="First Image"
                                         class="img_detail_room" />
                                    <button class="next btn btn-outline-success">
                                        <i class="bi bi-arrow-right"></i>
                                    </button>
                                </div>


                            }

                            <div class="room-info">
                                <h3>@phong.MaPhong  - <span id="loaiPhong-@phong.MaPhong">Hai giường đơn</span></h3>
                                <span id="@phong.MaPhong" class="room-type"></span>
                                @*   <span>
                            <i class="fa-solid fa-bed"></i> Loại phòng: <span id="loaiPhong-@phong.MaPhong">Hai giường đơn</span>

                            </span> *@

                                <span>
                                    <span>
                                        <i class="fa-regular fa-money-bill-1"></i> <span id="pricetheogio-@phong.MaPhong" class="room-price"
                                                                                         style="color:#ffc107;font-weight:700;"></span> VND/Giờ
                                    </span> | <span>
                                        <i class="fa-regular fa-money-bill-1"></i> <span id="pricetheongay-@phong.MaPhong"
                                                                                         style="color:#ffc107;font-weight:700;"></span> VND/Ngày
                                    </span>
                                </span>
                                <span>
                                    <i class="fa-solid fa-user-group"></i> Người lớn tối đa: <span id="slNguoiLon-@phong.LoaiPhong.SoLuongNguoiLon">@phong.LoaiPhong.SoLuongNguoiLon</span>
                                    |
                                    <i class="fa-solid fa-children"></i> Trẻ em tối đa: <span id="slTreEm-@phong.LoaiPhong.SoLuongTreEm">@phong.LoaiPhong.SoLuongTreEm</span>
                                </span>
                                @* <span id="phuThuTraMuon-@phong.MaPhong"></span> *@

                                <div class="row">
                                    <div class="col-sm">
                                        <label><i class="fa-solid fa-user-group"></i> Người lớn </label>
                                        <select class="form-select w-100" id="slNguoiLonDatPhong-@phong.MaPhong">
                                            @for (int i = 1; i <= phong.LoaiPhong.SoLuongNguoiLon; i++)
                                            {
                                                <option>
                                                    @i
                                                </option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm">
                                        <label><i class="fa-solid fa-children"></i> Trẻ em</label>
                                        <select class="form-select w-100" id="slTreEmDatPhong-@phong.MaPhong">
                                            @for (int i = 1; i <= phong.LoaiPhong.SoLuongTreEm; i++)
                                            {
                                                <option>@i</option>

                                            }
                                        </select>

                                    </div>
                                    @* xem vat tu *@
                                    <ul class="details-list">
                                        <li>
                                            <a class="btn-details" onclick="XemVatTu(this)">Xem chi tiết vật tư</a>
                                            <div class="overlay" id="overlay1"></div>
                                            <div class="details-container" id="detailsContainer1">
                                                <span class="close-btn" onclick="DongXemVatTu(this)"><i class="bi bi-x-lg"></i></span>
                                                @{
                                                    var qr_VatTuChiTiet = _db.ChiTietPhongVatTu.Where(s => s.MaPhong == phong.MaPhong && s.TinhTrang != "Đã xóa").ToList();
                                                    
                                                }
                                                <h4>Thông tin chi tiết</h4>
                                                <div class="inventory-items">
                                                    @foreach (var item in qr_VatTuChiTiet)
                                                    {
                                                     var qr_vatTu = _db.VatTu.FirstOrDefault(s => s.MaVatTu == item.MaVatTu );
                                                        
                                                        <div class="inventory-item">
                                                        <p>@qr_vatTu.TenVatTu: @item.SoLuong</p>
                                                    </div>
                                                    }
                                                    
                                                    
                                                </div>
                                                <button class="btn btn-danger" onclick="DongXemVatTu(this)">Đóng</button>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <a class="btn btn-warning" onclick="DatPhong('@phong.MaPhong')">Chọn phòng</a>

                            </div>
                        </div>
                    }
                </div>

                <div class="col-md-4">
                    <div class="infor-detail sticky-top" style="top:20px; max-height: 90vh; overflow-y: auto;">
                        <div class="infor-booked-room">
                            <h3>Thông tin đặt phòng</h3>
                            <hr />
                            <h2>ASAP Buôn Ma Thuột</h2>
                            <span></span><strong id="ngaynhan_text"></strong> - <strong id="ngaytra_text"></strong> <br /> <strong>Tổng: </strong> (<span id="ngay_text">0</span> ngày <span id="gio_text">0</span> giờ)
                            <br />
                            <strong>Số lượng người lớn: </strong><span id="SoLuongNguoiLonDat_text">0</span><span> người</span>
                            <br />
                            <strong>Số lượng trẻ em: </strong><span id="SoLuongTreEmDat_text">0</span><span>
                                người
                            </span>

                            <hr />
                            <h3>Thông tin phòng</h3>
                            <div id="Infor_Phong_Chon"></div>
                            <hr />
                            <h3>Thông tin dịch vụ</h3>
                            <div id="Infor_DichVu_Chon">
                                @* dịch vụ *@
                                <div id="ChonDichVu">
                                </div>
                                <button type="button" class="btn btn-outline-primary" id="AddThemDichVu">
                                    <i class="bi bi-plus"></i> Thêm dịch vụ
                                </button>

                            </div>
                            <hr />
                            <strong>Tổng tiền phòng:</strong> <span id="TongTienPhong" style="color:#FFCA2C">0 </span><span style="color:#FFCA2C"> VNĐ</span>
                            <br />
                            <strong hidden>Tổng dịch vụ đã đặt</strong> <span id="TongDichVuDaDat" hidden></span>
                            
                            <strong>Tổng tiền dịch vụ đã đặt:</strong> <span id="TongTienDichVuDaDat" style="color:#FFCA2C">0 </span><span style="color:#FFCA2C"> VNĐ</span>
                            <br />
                            <strong>Tổng cộng:</strong> <span id="TongTien" class="text-end">0 </span><span style="color:#FFCA2C"> VNĐ</span>
                            <br />
                            <a class="btn btn-warning button_bookroom " id="btn_DatPhong">Đặt ngay</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
</body>
<footer class="text-center text-lg-start text-white" style="background-color: #1c2331">
    <!-- Section: Social media -->

    <div>
        <a href="" class="text-white me-4">
            @* <i class="fab fa-facebook-f"></i> *@
        </a>
        <a href="" class="text-white me-4">
            @* <i class="fab fa-twitter"></i> *@
        </a>
        <a href="" class="text-white me-4">
            @* <i class="fab fa-google"></i> *@
        </a>
        <a href="" class="text-white me-4">
            @* <i class="fab fa-instagram"></i> *@
        </a>
        <a href="" class="text-white me-4">
            @* <i class="fab fa-linkedin"></i> *@
        </a>
        <a href="" class="text-white me-4">
            @* <i class="fab fa-github"></i> *@
        </a>
    </div>
    <!-- Right -->

    <section class="">

        <div class="container text-center text-md-start mt-5">
            <!-- Grid row -->
            <div class="row mt-3">
                <!-- Grid column -->
                <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
                    <!-- Content -->
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3891.9091181247622!2d108.0787266!3d12.7193516!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3171f7f4d3cab885%3A0x62453fb0d0ac7b44!2zS2jDoWNoIFPhuqFuIEFTQVA!5e0!3m2!1svi!2s!4v1700876295377!5m2!1svi!2s"
                            width="300" height="250" style="border:0;" allowfullscreen="" loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <!-- Grid column -->
                <!-- Grid column -->
                <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
                    <!-- Links -->
                    <h6 class="text-uppercase fw-bold">TIÊU CHÍ KHÁCH SẠN</h6>
                    <hr class="mb-4 mt-0 d-inline-block mx-auto"
                        style="width:160px; background-color: #7c4dff; height: 2px" />
                    <p>
                        Phục vụ tận tình
                    </p>
                    <p>
                        Chu đáo
                    </p>
                    <p>
                        Thân thiện
                    </p>
                    <p>
                        Phù hợp với yêu cầu khách hàng
                    </p>
                </div>
                <!-- Grid column -->
                <!-- Grid column -->
                <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
                    <!-- Links -->
                    <h6 class="text-uppercase fw-bold">NHÓM SÁNG LẬP</h6>
                    <hr class="mb-4 mt-0 d-inline-block mx-auto"
                        style="width: 130px; background-color: #7c4dff; height: 2px" />
                    <p>
                        Trương Minh Nhựt
                    </p>
                    <p>
                        Vũ Trần Phúc Thành
                    </p>
                    <p>
                        Trần Anh Thiện
                    </p>
                    <p>
                        Ngần Phi Hoàng
                    </p>
                </div>
                <!-- Grid column -->
                <!-- Grid column -->
                <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
                    <!-- Links -->
                    <h6 class="text-uppercase fw-bold">LIÊN HỆ</h6>
                    <hr class="mb-4 mt-0 d-inline-block mx-auto"
                        style="width: 60px; background-color: #7c4dff; height: 2px" />
                    <p><i class="fas fa-home mr-3"></i> 300 Hà Huy Tập, Thành phố Buôn Ma Thuột, Việt Nam</p>
                    <p><i class="fas fa-envelope mr-3"></i> KhachSanAsap@gmail.com</p>
                    <p><i class="fas fa-phone mr-3"></i> 0869536182</p>
                    <p><i class="fas fa-print mr-3"></i> 0869536182</p>
                </div>
                <!-- Grid column -->
            </div>
            <!-- Grid row -->
        </div>
    </section>


    <script src="~/js/JsTrangChuKhachHang.js"></script>
    <!-- Swiper JS -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        var swiper = new Swiper('.swiper-container', {
            slidesPerView: 1,
            spaceBetween: 30,
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            loop: true, // Cho phép lặp lại slide
            autoplay: {
                delay: 3000, // Thời gian chờ giữa các slide (3 giây)
                disableOnInteraction: false, // Tự động chuyển đến slide tiếp theo khi người dùng tương tác
            },
        });
    </script>

    <script>
        // PROFILE DROPDOWN
        const profile = document.querySelector('nav .profile');
        const imgProfile = profile.querySelector('img');
        const dropdownProfile = profile.querySelector('.profile-link');

        imgProfile.addEventListener('click', function () {
            dropdownProfile.classList.toggle('show');
        })

    </script>

    <!-- Copyright -->
</footer>


</html>